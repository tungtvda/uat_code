<?phpfunction familyTree($array){    if (is_array($array) === TRUE) {        for ($index = 0; $index < $array['count']; $index++) {            if ($array[$index]['ID'] == $_SESSION['member_AgentGroup']['param']['Agent']) {                $selected = 'selected="selected"';            }            $data = '<option style="padding-left:' . $array[$index]['Padding'] . 'px;" value="' . $array[$index]['ID'] . '" ' . $selected . '>' . $array[$index]['Name'] . ' - ' . $array[$index]['ID'] . ' | ' . $array[$index]['Company'] . '</option>';            echo $data;            unset($selected);            familyTree($array[$index]['Child']);        }    }}?><?php if ($_GET['param'] === "successd") { ?>    <div class="notify">Thank you. Your transaction has been requested successfully and is under processing. Your funds        are currently being verified and will be credited to your account within 5 - 10 minutes.    </div><?php } elseif ($_GET['param'] === "successw") { ?>    <div class="notify">Thank you. Your transaction has been requested successfully and is under processing. The amount        will be banked in to your designated bank account within 10 minutes.    </div><?php } elseif ($_GET['param'] === "successt") { ?>    <div class="notify">Thank you. Your transaction has been requested successfully and is under processing. Your funds        are currently being verified and will be transferred within 5 - 10 minutes.    </div><?php } elseif ($_GET['param'] === "failure") { ?>    <div class="error">Transaction error occurred.</div><?php } ?><?phpif (isset($_GET['page'])) {    $page = $_GET['page'];} else {    $page = 'all';}?><div id="search_box" <?php if ($data['content_param']['search'] == "off") { ?>class="search_initial"<?php } ?>>    <script type="text/javascript">        //<![CDATA[        $(function () {            jQuery("#search_trigger").click(function () {                $('#search_content').slideToggle();            });            $(".selectActive").change(function () {                idSelect = $(this).attr('countId');                value = $(this).val();                link = <?php echo $data['config']['SITE_DIR']; ?>'/agent/voucher/status';                $.ajax({                    method: "GET",                    url: link,                    data: "id=" + idSelect + '&value=' + value,                    success: function (response) {                        if (response != 1) {                            alert('Update status false')                        }                    }                });            });            $(".selectActiveDiv a").click(function () {                idSelect = $(this).attr('countId');                value = $(this).attr('key');                field_id_update = "#input_update_" + idSelect;                pass_value_id = "#pass_value_" + idSelect;                code_value_id = "#code_value_" + idSelect;                pass_value=$(pass_value_id).html();                code_value=$(code_value_id).html();                id_par=$(field_id_update).val();                current=$("#current_" + idSelect).html();                update_all=0;                if(value==3||value==4||value==5)                {                    update_all=1;                    if(value==3){                        value=0;                    }                    if(value==4){                        value=1;                    }                    if(value==5){                        value=2;                    }                }                field = "#status_" + idSelect;                if (value == 0) {                    text = 'Active';                }                if (value == 1) {                    text = 'Used';                }                if (value == 2) {                    text = 'Suspend';                }                if(update_all==1){                    var mess='Are you sure to apply "'+text+'" for all of voucher code '+code_value+'?';                    lnv.confirm({                        title: 'Confirm status updates?',                        content: mess,                        confirmBtnText: 'Ok',                        iconBtnText:'<i style="color: #669fc7;" class="ace-icon fa fa-check"></i>',                        confirmHandler: function () {                            link = <?php echo $data['config']['SITE_DIR']; ?>'/agent/voucher/status';                            $.ajax({                                method: "GET",                                url: link,                                data: "id=" + idSelect + '&value=' + value+'&update_all='+update_all+'&id_par='+id_par,                                success: function (response) {                                    if (response != 1) {                                        lnv.alert({                                            title: 'Message',                                            content: 'Update status false',                                            alertBtnText: 'Ok',                                            iconBtnText:'<i style="color: red;" class="ace-icon fa fa-exclamation-triangle red"></i>',                                            alertHandler: function () {                                            }                                        });                                    }                                    else {                                        $(field).text(text);                                        if(update_all==1){                                            lnv.alert({                                                title: 'Message',                                                content: 'Update status successfully',                                                alertBtnText: 'Ok',                                                iconBtnText:'<i style="color: red;" class="ace-icon fa fa-exclamation-triangle red"></i>',                                                alertHandler: function () {                                                }                                            });                                            link_reload=<?php echo $data['config']['SITE_DIR']; ?>'/agent/voucher/index?page=all';                                            window.location.replace(link_reload);                                        }                                    }                                }                            });                        },                        cancelBtnText: 'Cancel',                        cancelHandler: function () {                        }                    });                }                else{                    var mess='Are you sure to apply "'+text+'" for of password '+pass_value+'?';                    link = <?php echo $data['config']['SITE_DIR']; ?>'/agent/voucher/status';                    $.ajax({                        method: "GET",                        url: link,                        data: "id=" + idSelect + '&value=' + value+'&update_all='+update_all+'&id_par='+id_par,                        success: function (response) {                            if (response != 1) {                                lnv.alert({                                    title: 'Message',                                    content: 'Update status false',                                    alertBtnText: 'Ok',                                    iconBtnText:'<i style="color: red;" class="ace-icon fa fa-exclamation-triangle red"></i>',                                    alertHandler: function () {                                    }                                });                            }                            else{                                $(field).text(text);                                $("#current_" + idSelect).html(value);                                $(".active_show_" + idSelect).hide();                                $(".used_show_" + idSelect).hide();                                $(".suspend_show_" + idSelect).hide();                                if (value == 0) {                                    $(".used_show_" + idSelect).show();                                    $(".suspend_show_" + idSelect).show();                                }                                if (value == 2) {                                    $(".used_show_" + idSelect).show();                                    $(".active_show_" + idSelect).show();                                }                            }                        }                    });                }            });            $(".check_status").change(function () {                idSelect = $(this).attr('countId');                value = 0;                $(this).hide()                link = <?php echo $data['config']['SITE_DIR']; ?>'/agent/voucher/status';                $.ajax({                    method: "GET",                    url: link,                    data: "id=" + idSelect + '&value=' + value,                    success: function (response) {                        if (response != 1) {                            alert('Update status false')                        }                    }                });            });            $("#refresh_void").click(function () {                location.reload();            });            $("#select_all").change(function () {                if (!$('input:checkbox').is('checked')) {                    $('input:checkbox').prop('checked', true);                } else {                    $('input:checkbox').prop('checked', false);                }            });            $(".clickable").click(function () {                var pag = $(this).text();                $('#paging_number').val(pag);            });        });        //]]>    </script>    <style>        .dropbtn {            background-color: #ffffff;            color: #202020;            /* padding: 5px; */            font-size: 12px;            border: none;            cursor: pointer;            width: 80px;            padding-top: 5px;            padding-bottom: 5px;            padding-left: 5px;            padding-right: 16px;            text-rendering: auto;            letter-spacing: normal;            word-spacing: normal;            text-transform: none;            text-indent: 0px;            text-shadow: none;            display: inline-block;            text-align: start;            margin: 0em 0em 0em 0em;        }        .dropdown {            position: relative;            display: inline-block;        }        .dropdown-content {            display: none;            position: absolute;            background-color: #f5f5f5;;            min-width: 250px;            box-shadow: 0px 1px 17px 8px rgba(0, 0, 0, 0.2);            z-index: 1111;        }        .dropdown-content a {            color: black;            padding: 5px 10px;            text-decoration: none;            display: block;            border-bottom: 1px dotted;        }        .dropdown-content a:hover {            color: #f60;            background: #efefef;        }        .dropdown:hover .dropdown-content {            display: block;        }        .dropdown:hover .dropbtn {            background-color: #ffffff;        }    </style>    <h2>Search</h2> <input type="text" id="search" placeholder="  live search">    <div id="search_content" <?php if ($data['content_param']['search'] == "off") { ?>class="invisible"<?php } ?>>        <p>Submitting this search form without any data entry will show all results. Clicking on the Reset button will            also remove all filters and show all results.</p>        <form name="search_form" class="admin_table_nocell" id="search_form"              action="<?php echo $data['config']['SITE_DIR']; ?>/agent/voucher/index?page=<?php echo $page ?>"              method="get">            <table border="0" Mobilespacing="0" Mobilepadding="0">                <tr>                    <th scope="row"><label>Name</label></th>                    <td><input name="Name" type="text"                               value="" size=""/>                    </td>                    <td>&nbsp;</td>                    <th scope="row"><label>Code</label></th>                    <td><input name="Code" type="text" value="" size=""/>                    </td>                </tr>                <tr>                    <th scope="row"><label>Amount</label></th>                    <td><input name="Amount" type="text"                               value="" size=""/></td>                    <td>&nbsp;</td>                    <th scope="row"><label>Status</label></th>                    <td><select name="Status">                            <option value="0">Active</option>                            <option value="1">Used</option>                            <option value="2">Suspend</option>                        </select></td>                </tr>                <tr>                    <th scope="row"><label></label></th>                    <td>&nbsp;</td>                    <td>&nbsp;</td>                    <td>&nbsp;</td>                    <td class="text_right"><input type="submit" name="submit" value="Search" class="button"/>                        <a href="<?php echo $data['config']['SITE_DIR']; ?>/agent/voucher/index?page=all">                            <input type="button" value="Reset" class="button"/>                        </a></td>                </tr>            </table>        </form>    </div></div><div class="admin_results">    <div class="results_left">        <h2><?php echo $data['content_param']['query_title']; ?></h2>        <?php if ($data['content_param']['count'] > 0) { ?>            <div>Total Results: <span id="total_res"><?php echo $data['content_param']['total_results']; ?></span></div>        <?php } ?>    </div>    <div class="results_right">        <a href='javascript:void(0)' id="refresh_void">            <img id="img_loadding" style="margin-left: -35px;position: absolute;margin-top: -3px; width: 30px"                 src="<?php echo $data['config']['SITE_DIR']; ?>/upload/agent/refresh.png">        </a>        <?php if ($_SESSION['agent']['TypeID'] == '1') { ?>            <a href='/agent/voucher/add?apc=apcg'>                <input type="button" class="button" value="Create Voucher">            </a>        <?php } ?>        <a href='/agent/voucher/accountSummary?apc=apcg'>            <input type="button" class="button" value="Account Summary">        </a>        <a href='/agent/voucher/index?page=all'>            <input type="button" class="button" value="Vouchers">        </a>        <?php if ($_SESSION['agent']['operator']['ProfileID'] == '2' || $_SESSION['agent']['operator']['ProfileID'] == '3') { ?>            <a href='/voucher/agent/add?apc=apcg'>                <input type="button" class="button" value="Create Voucher">            </a>        <?php } ?>        <!--<a href='<?php echo $data['config']['SITE_DIR']; ?>/admin/transaction/export/AdminIndex'>    <input type="button" class="button" value="Export to CSV">    </a>--><?php echo $data['content_param']['paginate']; ?></div>    <div class="clear"></div></div><?php if ($data['content_param']['count'] > 0) { ?>    <table id="myTable" class="admin_table" border="0" cellpadding="0" cellspacing="0">        <thead>        <script>            $(document).ready(function () {                checkAndUncheck();            });            function checkAndUncheck() {                $("input[name='checkAll']").click(function () {                    if (this.checked) {                        $('#myTable tbody input[type="checkbox"]:not(:checked)').trigger('click');                    } else {                        $('#myTable tbody input[type="checkbox"]:checked').trigger('click');                    }                    var lenght = $('.child:checked').length;                    // Prevent click event from propagating to parent                    var pag = $('#paging_number').val();                    var pag_end = Math.ceil(lenght / 20);                    var search = $('#search').val();                    var total_res = parseInt($('#total_res').html());                    if (search != '' && total_res > 0) {                        for (i = 21; i <= lenght; i++) {                            field = "check_" + i;                            document.getElementById(field).checked = false;                        }                    }                    else {                        if (pag == 1) {                            if (lenght > 20) {                                for (i = 21; i <= lenght; i++) {                                    field = "check_" + i;                                    document.getElementById(field).checked = false;                                }                            }                        }                        else {                            if (pag == pag_end) {                                var index = (pag_end - 1) * 20;                                for (i = 1; i <= index; i++) {                                    field = "check_" + i;                                    document.getElementById(field).checked = false;                                }                            } else {                                var index_before = (pag - 1) * 20;                                for (i = 1; i <= index_before; i++) {                                    field = "check_" + i;                                    document.getElementById(field).checked = false;                                }                                var index_after = (pag * 20) + 1;                                for (i = index_after; i <= lenght; i++) {                                    field = "check_" + i;                                    document.getElementById(field).checked = false;                                }                            }                        }                    }                });                $("#submit_action").click(function () {                    var lenght = $('.child:checked').length;                    var action = $("#value_action option:selected").val();                    if (lenght == 0) {                        lnv.alert({                            title: 'Message',                            content: 'Please choose item',                            alertBtnText: 'Ok',                            iconBtnText:'<i style="color: red;" class="ace-icon fa fa-exclamation-triangle red"></i>',                            alertHandler: function () {                            }                        });                    } else {                        if (action == '') {                            lnv.alert({                                title: 'Message',                                content: 'Please select a status',                                alertBtnText: 'Ok',                                iconBtnText:'<i style="color: red;" class="ace-icon fa fa-exclamation-triangle red"></i>',                                alertHandler: function () {                                }                            });                        }                        else {                            lnv.confirm({                                title: 'Confirm status updates',                                content: 'Would you like to update the status of all the checked items?',                                confirmBtnText: 'Ok',                                iconBtnText:'<i style="color: #669fc7;" class="ace-icon fa fa-check"></i>',                                confirmHandler: function () {                                    $("#target").submit();                                },                                cancelBtnText: 'Cancel',                                cancelHandler: function () {                                }                            });                        }                    }                });            }        </script>        <th><input type="checkbox" name="checkAll" id="checkAll"><input type="number" hidden value="1" id="paging_number"></th>        <th>No</th>        <th>Name</th>        <th>Code</th>        <th>Amount</th>        <th>Agent URL</th>        <th>User by</th>        <th>Password</th>        <th>Status</th>        <th>Action update status</th>        <th class="center">View</th>        </thead>        <?php $stt = 1; ?>        <form action="" method="post" id="target">            <select id="value_action" name="value_action">                <option value="">Status</option>                <option value="0">Active</option>                <option value="1">Used</option>                <option value="2">Suspend</option>            </select>            <input type="button" id="submit_action" value="Update">            <?php for ($i = 0; $i < $data['content_param']['count']; $i++) { ?>                <tbody class="admin_table_body">                <tr>                    <td id=""><input type="checkbox" id="check_<?php echo $stt ?>" name="check_box_action[]"                                     value="<?php echo $data['content'][$i]['Id_pass']; ?>" class="child"></td>                    <td><?php echo $stt ?></td>                    <td><?php echo $data['content'][$i]['Name']; ?></td>                    <td><span id="code_value_<?php echo $data['content'][$i]['Id_pass']; ?>"><?php echo $data['content'][$i]['Code']; ?></span></td>                    <td><?php echo number_format($data['content'][$i]['Amount'], 2, '.', ','); ?></td>                    <td><?php echo $data['content'][$i]['Company']; ?></td>                    <td>                        <?php                        $name='_';                        if($data['content'][$i]['Name_user']!=''){                            $name=$data['content'][$i]['Name_user'];                        }                        ?>                        <?php echo $name; ?>                    </td>                    <td>                        <span id="pass_value_<?php echo $data['content'][$i]['Id_pass']; ?>"><?php echo $data['content'][$i]['Password']; ?></span>                    </td>                    <?php                    if ($data['content'][$i]['Status'] == 0) {                        $status = "Active ";                    } else {                        if ($data['content'][$i]['Status'] == 1) {                            $status = "Used";                        } else {                            $status = "Suspend";                        }                    }?>                    <td>                        <?php echo $status?>                    </td>                    <td>                        <?php                        $hidden_active='';                        $hidden_used='';                        $hidden_suspend='';                        if ($data['content'][$i]['Status'] == 0) {                            $status = "Active ";                            $hidden_active='display: none;';                        } else {                            if ($data['content'][$i]['Status'] == 1) {                                $status = "Used";                                $hidden_used='display: none;';                            } else {                                $status = "Suspend";                                $hidden_suspend='display: none;';                            }                        }                        if ($_SESSION['agent']['TypeID'] == '2') {                            echo "<span >$status</span>";                        } else {                            echo "<span style='color:#f5f5f5; display: none'>$status</span>";                        }                        ?>                        <?php if ($_SESSION['agent']['TypeID'] == '1') { ?>                            <div class="dropdown">                                <a href="javascript:void()" class="dropbtn">                                    <span                                        id="status_<?php echo $data['content'][$i]['Id_pass']; ?>"><?php echo $status; ?></span>                                    <?php if ($data['content'][$i]['Status'] != 1) { ?>                                        <img src="<?php echo $data['config']['SITE_DIR']; ?>/upload/agent/nav-drop.png"                                             style=" width: 13px;position: absolute;margin-top: 1px;right: 5px;">                                    <?php } ?>                                </a>                                <?php if ($data['content'][$i]['Status'] != 1) { ?>                                    <input hidden id="input_update_<?php echo $data['content'][$i]['Id_pass']; ?>" value="<?php echo $data['content'][$i]['Id']; ?>">                                    <div id="show_div_<?php echo $data['content'][$i]['Id_pass']; ?>"                                         class="dropdown-content selectActiveDiv">                                        <span hidden id="current_<?php echo $data['content'][$i]['Id_pass']; ?>"><?php echo $data['content'][$i]['Status']; ?></span>                                        <a class="active_show_<?php echo $data['content'][$i]['Id_pass']; ?>" style="<?php echo $hidden_active?>"  countID="<?php echo $data['content'][$i]['Id_pass']; ?>"                                           href="javascript:void(0)" key="0">                                            Active<!--                                            <img src="--><?php //echo $data['config']['SITE_DIR']; ?><!--/upload/agent/active.png">-->                                        </a>                                        <a class="active_show_<?php echo $data['content'][$i]['Id_pass']; ?>" style="<?php echo $hidden_active?>"  countID="<?php echo $data['content'][$i]['Id_pass']; ?>"                                           href="javascript:void(0)" key="3">                                           Apply "Active" for all of <?php echo $data['content'][$i]['Code']; ?>                                        </a>                                        <a class="used_show_<?php echo $data['content'][$i]['Id_pass']; ?>" style=" <?php echo $hidden_used?>" countID="<?php echo $data['content'][$i]['Id_pass']; ?>"                                           href="javascript:void(0)" key="1">                                            Used<!--                                            <img src="--><?php //echo $data['config']['SITE_DIR']; ?><!--/upload/agent/used.png">-->                                        </a>                                        <a class="used_show_<?php echo $data['content'][$i]['Id_pass']; ?>" style="<?php echo $hidden_used?>"  countID="<?php echo $data['content'][$i]['Id_pass']; ?>"                                           href="javascript:void(0)" key="4">                                            Apply "Used" for all of <?php echo $data['content'][$i]['Code']; ?>                                        </a>                                        <a class="suspend_show_<?php echo $data['content'][$i]['Id_pass']; ?>" style="<?php echo $hidden_suspend?>"  countID="<?php echo $data['content'][$i]['Id_pass']; ?>"                                           href="javascript:void(0)" key="2">                                            Suspend<!--                                            <img src="--><?php //echo $data['config']['SITE_DIR']; ?><!--/upload/agent/suspend.png">-->                                        </a>                                        <a class="suspend_show_<?php echo $data['content'][$i]['Id_pass']; ?>" style="<?php echo $hidden_suspend?>"  countID="<?php echo $data['content'][$i]['Id_pass']; ?>"                                           href="javascript:void(0)" key="5">                                            Apply "Suspend" for all of <?php echo $data['content'][$i]['Code']; ?>                                        </a>                                    </div>                                <?php } ?>                            </div>                            <!--<select countID = "<?php echo $data['content'][$i]['Id_pass']; ?>" class="selectActive">                            <option value="0" <?php if ($data['content'][$i]['Status'] == 0) echo "selected='selected'" ?>>Acitve</option>                            <option value="1" <?php if ($data['content'][$i]['Status'] == 1) echo "selected='selected'" ?>>Used</option>                            <option value="2" <?php if ($data['content'][$i]['Status'] == 2) echo "selected='selected'" ?>>Suspend</option>                        </select>-->                        <?php } ?>                    </td>                    <!--<td style="text-align: center">                    <?php if ($_SESSION['agent']['TypeID'] == '1' && $data['content'][$i]['Status'] == 2) { ?>                        <input class="check_status" type="checkbox" countID = "<?php echo $data['content'][$i]['Id_pass']; ?>" checked>                    <?php } ?>-->                    </td>                    <td>                        <div align="center">                            <a href="<?php echo $data['config']['SITE_DIR']; ?>/agent/voucher/view/<?php echo $data['content'][$i]['Id']; ?>">View </a>                        </div>                    </td>                    <!--                --><?php //if ($_SESSION['agent']['TypeID'] == '1') { ?>                    <!--                    <td>-->                    <!--                        <div align="center"><a onclick="confirmDelete()"-->                    <!--                                href='-->                    <?php //echo $data['config']['SITE_DIR']; ?><!--/agent/voucher/delete/-->                    <?php //echo $data['content'][$i]['Id']; ?><!--?apc=apcg&page=-->                    <?php //echo $page?><!--'>Delete</a>-->                    <!--                        </div>-->                    <!--                    </td>-->                    <!---->                    <!--                --><?php //} ?>                    <?php /*if($_SESSION['agent']['operator']['ProfileID']=='2' || $_SESSION['agent']['operator']['ProfileID']=='3'){ ?>    <td><div align="center"><a href='<?php echo $data['config']['SITE_DIR']; ?>/agent/member/edit/<?php echo $data['content'][$i]['ID']; ?>?apc=apcg'>Edit</a></div></td>    <?php }*/ ?>                </tr>                </tbody>                <?php $stt++ ?>            <?php } ?>        </form>        <!--<tr>    <td><?php echo $data['content'][$i][$j]['MemberID']; ?></td>    <td class="center"><?php echo $data['content'][$i]['ProductID']; ?></td>    <td class="center"><?php echo $data['content'][$i]['Username']; ?></td>    <td class="center"><?php echo $data['content'][$i]['Password']; ?></td>    <td class="center"><?php echo $data['content'][$i]['Total']; ?></td>-->        <!--<td>        <?php if ($data['content'][$i][$j]['TypeID'] == 'Withdrawal') { ?>        <?php echo $data['content'][$i][$j]['Bank']; ?><br />        <?php } ?>        <?php if ($data['content'][$i][$j]['TypeID'] != 'Transfer') { ?>            <?php echo $data['content'][$i][$j]['Description']; ?>        <?php } ?>        <?php if ($data['content'][$i][$j]['TypeID'] == 'Deposit') { ?>        (Deposit Channel: <?php echo $data['content'][$i][$j]['DepositChannel']; ?> - <?php echo $data['content'][$i][$j]['Bank']; ?>)        <?php } ?>        <?php if ($data['content'][$i][$j]['TypeID'] == 'Transfer') { ?>            <?php echo $data['content'][$i][$j]['TransferFrom']; ?> -> <?php echo $data['content'][$i][$j]['TransferTo']; ?>        <?php } else { ?>            <?php if ($data['content'][$i][$j]['ReferenceCode'] != "") { ?>            <div style="margin-top:5px;">Reference Code: <?php echo $data['content'][$i][$j]['ReferenceCode']; ?>            <?php } else { ?>            <div style="margin-top:5px;">Reference Code: N/A            <?php } ?>        <?php } ?>        </div></td>    <td style="white-space:nowrap; text-align: right">        <?php if ($data['content'][$i][$j]['TypeID'] == 'Deposit') { ?>        <?php echo Helper::displayCurrency($data['content'][$i][$j]['In']); ?>        <?php } ?>        <?php if ($data['content'][$i][$j]['TypeID'] == 'Withdrawal') { ?>        <?php echo Helper::displayCurrency($data['content'][$i][$j]['Out']); ?>        <?php } ?>        <?php if ($data['content'][$i][$j]['TypeID'] == 'Transfer') { ?>        <?php echo Helper::displayCurrency($data['content'][$i][$j]['Amount']); ?>        <?php } ?>    </td>    <td class="center"><?php echo $data['content'][$i][$j]['Status']; ?></td>-->        <!--</tr>-->    </table><?php } else { ?>    <p>No records.</p><?php } ?>